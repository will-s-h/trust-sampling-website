<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Using projective dynamics to add dynamics capability to a pre-trained kinematics generative model of human motion">
  <meta name="keywords" content="Trust Sampling, Generative Models, Diffusion, Image Super-resolution, Human Motion">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Constrained Diffusion with Trust Sampling</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.ico">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Constrained Diffusion with Trust Sampling</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://willhuang.me">William Huang</a>,
            </span>
            <span class="author-block">
              <a href="https://cs.stanford.edu/~yifengj/">Yifeng Jiang</a>,</span>
            <span class="author-block">
              <a href="https://tml.stanford.edu/people/tom-van-wouwe">Tom Van Wouwe</a>,</span>
            <span class="author-block">
              <a href="https://profiles.stanford.edu/c-karen-liu">C. Karen Liu</a>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">Stanford University</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">

              <span class="link-block">
                <a href="https://arxiv.org/abs/2411.10932"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <span class="link-block">
                <a href="https://youtu.be/xAUHmU1mGVk"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/will-s-h/trust-sampling"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>

            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">

      <img id="teaser" src="./static/images/Teaser_Figure.png"
       alt="Teaser figure."/>
      <h2 class="subtitle has-text-centered">
        Trust sampling, a training-free loss-guided diffusion method for SoTA constraint following in image and human motion tasks.
      </h2>
    </div>
  </div>
</section>



<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">

          Diffusion models have demonstrated significant promise in various generative tasks; however, they often struggle to satisfy challenging constraints. 
          Our approach addresses this limitation by rethinking training-free loss-guided diffusion from an optimization perspective. We formulate a series of constrained optimizations throughout the inference process of a diffusion model. 
          In each optimization, we allow the sample to take multiple steps along the gradient of the proxy constraint function until we can no longer trust the proxy, according to the variance at each diffusion level. 
          Additionally, we estimate the state manifold of diffusion model to allow for early termination when the sample starts to wander away from the state manifold at each diffusion step. 
          Trust sampling effectively balances between following the unconditional diffusion model and adhering to the loss guidance, enabling more flexible and accurate constrained generation. 
          We demonstrate the efficacy of our method through extensive experiments on complex tasks, and in drastically different domains of images and 3D motion generation, showing significant improvements over existing methods in terms of generation quality. 
          Our implementation is available at this <a href="https://github.com/will-s-h/trust-sampling">https://github.com/will-s-h/trust-sampling.</a>

        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Image results. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Image Results</h2>

        <img id="all pics" src="./static/images/all_pictures.png" alt="Comparison of Trust Sampling with other methods."/>

        <div class="content has-text-justified">
          The above is a comparison of Trust Sampling with other loss-guided constraint following diffusion methods, including DPS, DSG, and LGD-MC.
        </div>

        <img id="deblur" src="./static/images/gaussian_deblur.png" alt="Gaussian Deblurring samples."/>

        <div class="content has-text-justified">
          Above are 20 samples of Gaussian Deblurring across FFHQ and ImageNet.
        </div>

        <img id="inpainting" src="./static/images/inpainting.png" alt="Inpainting samples."/>

        <div class="content has-text-justified">
          Above are 20 samples of Inpainting across FFHQ and ImageNet.
        </div>

        <img id="superres" src="./static/images/superres.png" alt="Super Resolution samples."/>

        <div class="content has-text-justified">
          Above are 20 samples of Super Resolution across FFHQ and ImageNet.
        </div>
      </div>
    </div>
    <!--/ Image Results. -->


    <!-- Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Human Motion Results</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/xAUHmU1mGVk?si=WtIkR-51ZK_0677U"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
        <img id="motion tasks" src="./static/images/figure_motion_tasks.png" alt="Human Motion Examples"/>

        <div class="content has-text-justified">
          Above shows keyframes of human motions constrained by Trust Sampling.
        </div>
        
      </div>
    </div>
    <!--/ Paper video. -->
    
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{huang2024trust,
  author    = {Huang, William and Jiang, Yifeng and Van Wouwe, Tom and Liu, C Karen},
  title     = {Constrained Diffusion with Trust Sampling},
  journal   = {NeurIPS},
  year      = {2024},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
